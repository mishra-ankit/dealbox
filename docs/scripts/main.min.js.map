{"version":3,"sources":["main.js"],"names":["isLocalhost","Boolean","window","location","hostname","match","navigator","protocol","serviceWorker","register","then","registration","onupdatefound","controller","installingWorker","installing","onstatechange","state","Error","e","console","error","angular","module","$http","$scope","$timeout","snackbarContainer","document","querySelector","apiRoot","dialog","token","USER_DB","mukesh","interestList","mai","ankit","method","url","headers","Authorization","response","log","isLoggedIn","logIn","showLoading","id","pin","userObj","get","allDeals","data","deals","filter","deal","indexOf","category","alert","LIST","DETAILS","appState","goTo","currentDeal","favList","addToFav","isFav","push","message","MaterialSnackbar","showSnackbar","removeFav","boughtDeals","buy","showModal","showHistory","addEventListener","close","bought","body","debitAccountNumber","accNum","creditAccountNumber","amount","price","paymentDate","Date"],"mappings":";;;;;;;;;;;;;;;;;;CAmBA,WACA,YAMA,IAAAA,GAAAC,QAAA,cAAAC,OAAAC,SAAAC,UAEA,UAAAF,OAAAC,SAAAC,UAEAF,OAAAC,SAAAC,SAAAC,MACA,0DAIA,kBAAAC,aACA,WAAAJ,OAAAC,SAAAI,UAAAP,IACAM,UAAAE,cAAAC,SAAA,qBACAC,KAAA,SAAAC,GAEAA,EAAAC,cAAA,WAKA,GAAAN,UAAAE,cAAAK,WAAA,CAGA,GAAAC,GAAAH,EAAAI,UAEAD,GAAAE,cAAA,WACA,OAAAF,EAAAG,OACA,IAAA,YAKA,KAEA,KAAA,YACA,KAAA,IAAAC,OAAA,yDAvBAZ,SAgCA,SAAAa,GACAC,QAAAC,MAAA,4CAAAF,KAgBAG,QAAAC,OAAA,UASAD,QAAAC,OAAA,OACAV,WAAA,YAAA,QAAA,SAAA,WAAA,SAAAW,EAAAC,EAAAC,GACA,GAAAC,GAAAC,SAAAC,cAAA,uBAEAC,EAAA,oCAEAC,EAAAH,SAAAC,cAAA,UAEAG,EAAA,uCAEAC,GACAC,QACAC,cAAA,QAAA,eAEAC,KACAD,cAAA,qBAAA,eAEAE,OACAF,cAAA,uBAIAX,IACAc,OAAA,MACAC,IAAAT,EAAA,+BACAU,SAAAC,cAAA,UAAAT,KAEAtB,KAAA,SAAAgC,GACAtB,QAAAuB,IAAAD,KANAlB,SAQA,SAAAkB,GACAtB,QAAAuB,IAAAD,KAGAjB,EAAAmB,WAAA,WACA,MAAAnB,GAAA,SAGAA,EAAAoB,MAAA,WACApB,EAAAqB,aAAA,EACArB,EAAAsB,IAAAtB,EAAAuB,KAAAf,EAAAR,EAAAsB,MACAtB,EAAAwB,QAAAhB,EAAAR,EAAAsB,KAIAvB,EAAA0B,IAAA,gEACAxC,KAAA,SAAAgC,GAEAjB,EAAA0B,SAAAT,EAAAU,KACA3B,EAAA4B,MAAAX,EAAAU,KAAAE,OAAA,SAAAC,GACA,MAAA9B,GAAAwB,QAAAd,aAAAqB,QAAAD,EAAAE,iBALAjC,SAQA,SAAAkB,GACAgB,MAAA,8BAGAhC,EAAA,WACAD,EAAAqB,aAAA,GACA,KAGA,IAAAa,GAAA,OAAAC,EAAA,SACAnC,GAAAoC,SAAAF,EAEAlC,EAAAqC,KAAA,SAAAP,GACA9B,EAAAoC,SAAAD,EACAnC,EAAAsC,YAAAR,EACAA,IAAAI,IACAlC,EAAAoC,SAAAF,IAIAlC,EAAAuC,WAEAvC,EAAAwC,SAAA,SAAAV,GACAA,EAAAW,OAAA,EACAzC,EAAAuC,QAAAG,KAAAZ,EACA,IAAAH,IAAAgB,QAAA,uBACAzC,GAAA0C,iBAAAC,aAAAlB,IAGA3B,EAAA8C,UAAA,SAAAhB,GACAA,EAAAW,OAAA,CAEA,IAAAd,IAAAgB,QAAA,2BACAzC,GAAA0C,iBAAAC,aAAAlB,IAGA3B,EAAA+C,eAEA/C,EAAAgD,IAAA,WAEA1C,EAAA2C,aAGAjD,EAAAkD,YAAA,WACAlD,EAAA4B,MAAA5B,EAAA+C,aAGAzC,EAAAF,cAAA,UAAA+C,iBAAA,QAAA,WACA7C,EAAA8C,UAGA9C,EAAAF,cAAA,SAAA+C,iBAAA,QAAA,WACA7C,EAAA8C,QACAnD,EAAA,WACAD,EAAAsC,YAAAe,QAAA,EAEAtD,GACAc,OAAA,MACAC,IAAAT,EAAA,wBACAU,SAAAC,cAAA,UAAAT,GACA+C,MACAC,mBAAAvD,EAAAwB,QAAAgC,OACAC,oBAAAzD,EAAAsC,YAAAkB,OACAE,OAAA1D,EAAAsC,YAAAqB,MACAC,YAAA,GAAAC,SAGA5E,OACAe,EAAA+C,YAAAL,KAAA1C,EAAAsC,cACA","file":"main.min.js","sourcesContent":["/*!\n *\n *  Web Starter Kit\n *  Copyright 2015 Google Inc. All rights reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    https://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License\n *\n */\n/* eslint-env browser */\n(function () {\n  'use strict';\n\n  // Check to make sure service workers are supported in the current browser,\n  // and that the current page is accessed from a secure origin. Using a\n  // service worker from an insecure origin will trigger JS console errors. See\n  // http://www.chromium.org/Home/chromium-security/prefer-secure-origins-for-powerful-new-features\n  var isLocalhost = Boolean(window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n  );\n\n  if ('serviceWorker' in navigator &&\n    (window.location.protocol === 'https:' || isLocalhost)) {\n    navigator.serviceWorker.register('service-worker.js')\n      .then(function (registration) {\n        // updatefound is fired if service-worker.js changes.\n        registration.onupdatefound = function () {\n          // updatefound is also fired the very first time the SW is installed,\n          // and there's no need to prompt for a reload at that point.\n          // So check here to see if the page is already controlled,\n          // i.e. whether there's an existing service worker.\n          if (navigator.serviceWorker.controller) {\n            // The updatefound event implies that registration.installing is set:\n            // https://slightlyoff.github.io/ServiceWorker/spec/service_worker/index.html#service-worker-container-updatefound-event\n            var installingWorker = registration.installing;\n\n            installingWorker.onstatechange = function () {\n              switch (installingWorker.state) {\n                case 'installed':\n                  // At this point, the old content will have been purged and the\n                  // fresh content will have been added to the cache.\n                  // It's the perfect time to display a \"New content is\n                  // available; please refresh.\" message in the page's interface.\n                  break;\n\n                case 'redundant':\n                  throw new Error('The installing ' +\n                    'service worker became redundant.');\n\n                default:\n                // Ignore\n              }\n            };\n          }\n        };\n      }).catch(function (e) {\n      console.error('Error during service worker registration:', e);\n    });\n  }\n\n  // Your custom JavaScript goes here\n  function share() {\n    navigator.share({\n      title: document.title,\n      text: \"Great Deal\",\n      url: window.location.href\n    })\n  }\n\n  /**\n   * Created by Ram on 05-Sep-17.\n   */\n  angular.module('app', [])\n  // .config(['$locationProvider', '$routeProvider', function($locationProvider, $routeProvider) {\n  //   $routeProvider.when('/users', {\n  //     templateUrl: 'users.html',\n  //     controller: 'UserCtrl'\n  //   });\n  //   $routeProvider.otherwise({redirectTo: '/users'});\n  // }]);\n\n  angular.module('app')\n    .controller('UserCtrl', [\"$http\", \"$scope\", \"$timeout\", function ($http, $scope, $timeout) {\n      var snackbarContainer = document.querySelector('#demo-toast-example');\n      var id = null;\n      var apiRoot = \"https://dnbapistore.com/hackathon\";\n      var userObj;\n      var dialog = document.querySelector('dialog');\n\n      var token = '67e6636a-75d1-3c01-8742-617f7a32ce3d';\n\n      var USER_DB = {\n        'mukesh': {\n          interestList: ['Sport', 'Restaurent']\n        },\n        'mai': {\n          interestList: ['Kitchen / Interior', 'Electronic']\n        },\n        'ankit': {\n          interestList: ['Flower / Gardening']\n        }\n      };\n\n      $http({\n        method: 'GET',\n        url: apiRoot + \"/banks/1.0/bank/atm/zip/0367\",\n        headers: {'Authorization': 'Bearer ' + token}\n      })\n        .then(function (response) {\n          console.log(response);\n        })\n        .catch(function (response) {\n          console.log(response);\n        })\n\n      $scope.isLoggedIn = function () {\n        return ($scope.userObj);\n      };\n\n      $scope.logIn = function () {\n        $scope.showLoading = true;\n        if ($scope.id && $scope.pin && USER_DB[$scope.id]) {\n          $scope.userObj = USER_DB[$scope.id];\n        }\n\n        //Fetch relevant deals.\n        $http.get(\"https://mockbin.org/bin/b4ae1d0e-c985-42f2-8f2f-47bbbf14cb70\")\n          .then(function (response) {\n            // TODO : Filter only personalized deals.\n            $scope.allDeals = response.data;\n            $scope.deals = response.data.filter(function (deal) {\n              return ($scope.userObj.interestList.indexOf(deal.category) > -1);\n            });\n          })\n          .catch(function (response) {\n            alert(\"Error is fetching deals.\");\n          });\n\n        $timeout(function () {\n          $scope.showLoading = false;\n        }, 2000);\n      };\n\n      var LIST = 'list', DETAILS = 'details';\n      $scope.appState = LIST;\n\n      $scope.goTo = function (deal) {\n        $scope.appState = DETAILS;\n        $scope.currentDeal = deal;\n        if (deal === LIST) {\n          $scope.appState = LIST;\n        }\n      };\n\n      $scope.favList = [];\n\n      $scope.addToFav = function (deal) {\n        deal.isFav = true;\n        $scope.favList.push(deal);\n        var data = {message: 'Added to favourites!'};\n        snackbarContainer.MaterialSnackbar.showSnackbar(data);\n      };\n\n      $scope.removeFav = function (deal) {\n        deal.isFav = false;\n        // TODO : Actual remove from array.\n        var data = {message: 'Removed from favourites!'};\n        snackbarContainer.MaterialSnackbar.showSnackbar(data);\n      };\n\n      $scope.boughtDeals = [];\n\n      $scope.buy = function () {\n        // TODO : Remove from main list.\n        dialog.showModal();\n      };\n\n      $scope.showHistory = function () {\n        $scope.deals = $scope.boughtDeals;\n      }\n\n      dialog.querySelector('.close').addEventListener('click', function () {\n        dialog.close();\n      });\n\n      dialog.querySelector('.done').addEventListener('click', function () {\n        dialog.close();\n        $timeout(function () {\n          $scope.currentDeal.bought = true;\n          // TODO : Do transaction using payments API\n          $http({\n            method: 'PUT',\n            url: apiRoot + \"/payments/1.0/payment\",\n            headers: {'Authorization': 'Bearer ' + token},\n            body : {\n              \"debitAccountNumber\": $scope.userObj.accNum,\n              \"creditAccountNumber\": $scope.currentDeal.accNum,\n              \"amount\": $scope.currentDeal.price,\n              \"paymentDate\": (new Date())\n            }\n          })\n          .then();\n          $scope.boughtDeals.push($scope.currentDeal);\n        }, 1);\n      });\n    }]);\n})();\n"]}